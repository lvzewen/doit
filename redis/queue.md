# 消息队列

## 队列

是一种特殊的线性表，特殊之处在于它只允许在表的前端（front）进行删除操作，而在表的后端（rear）进行插入操作，和栈一样，队列是一种操作受限制的线性表。进行插入操作的端称为队尾，进行删除操作的端称为队头。

## 消息队列

### 为什么使用消息队列

是在消息的传输过程中保存消息的容器。解耦、异步、削峰或解耦、提速、广播、削峰

另外上面提到的“有界”和“无界”，指的是队列的容量大小。有界 指的是创建队列时必须指定队列的容量；无界 创建队列时无需指定队列的容量，容量大小取决于jvm实例分配的内存空间大小。在海量业务场景里，我们期望队列的容量是无限的，但单个jvm实例 即便是使用“无界”队列 由于单个实例内存是有限的，最终无法容纳下海量的消息数据。聪明的程序员就想 能不能使用一个第三方的队列来存储这些数据呢？当然是可以的，这就产生了“消息队列”。

## redis中的消息队列

redis中可以使用自带的publish和subscribe命令完成“消息推送”和“消息拉取”功能，实现消息队列。但这种方式有一个缺陷就是，消费者必须一致在线，否则会出现消费遗漏。

首先思考下做一个轻量化的“消息队列”，需要满足些什么基本要求：
1、消费顺序保持跟生产顺序一致。
2、对于广播消息，某个消费者实例重启后，能重新收到消息。
3、定时清理 所有消费者都已经消费过的数据，防止容量无限增长。